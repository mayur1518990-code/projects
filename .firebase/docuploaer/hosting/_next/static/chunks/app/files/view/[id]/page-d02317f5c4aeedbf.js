(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[628],{3409:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>c,Z:()=>o});var s=a(4568),l=a(7620),r=a(8930),i=a(5195);let n=(0,l.createContext)(void 0);function c(e){let{children:t}=e,a=function(){let[e,t]=(0,l.useState)(null),[a,s]=(0,l.useState)(!0),[n,c]=(0,l.useState)(!1),o=(0,l.useCallback)(()=>{try{let e=localStorage.getItem("user");return e?JSON.parse(e):null}catch(e){return null}},[]),d=(0,l.useCallback)(e=>{var t;return{userId:e.uid,name:e.displayName||(null==(t=e.email)?void 0:t.split("@")[0])||"User",email:e.email||"",phone:e.phoneNumber||""}},[]);(0,l.useEffect)(()=>{let e,a;return(async()=>{try{a=setTimeout(()=>{s(!1),c(!0)},5e3),e=(0,r.hg)(i.j2,e=>{if(clearTimeout(a),e){let a=o();a?t(a):t(d(e))}else t(null),setTimeout(()=>{localStorage.removeItem("user"),localStorage.removeItem("token")},0);s(!1),c(!0)})}catch(e){clearTimeout(a),s(!1),c(!0)}})(),()=>{e&&e(),a&&clearTimeout(a)}},[o,d]);let u=(0,l.useCallback)(async()=>{try{await (0,r.CI)(i.j2),t(null),setTimeout(()=>{localStorage.removeItem("user"),localStorage.removeItem("token")},0)}catch(e){}},[]);return(0,l.useMemo)(()=>({user:e,loading:a||!n,signOut:u,initialized:n}),[e,a,n,u])}();return(0,s.jsx)(n.Provider,{value:a,children:t})}function o(){let e=(0,l.useContext)(n);if(void 0===e)throw Error("useAuthContext must be used within an AuthProvider");return e}},4490:(e,t,a)=>{Promise.resolve().then(a.bind(a,6411))},5195:(e,t,a)=>{"use strict";let s,l,r;a.d(t,{db:()=>r,j2:()=>l});var i=a(861),n=a(8930),c=a(8755),o=a(4637);let d={apiKey:"AIzaSyDCuDm1NQHRxzcBto7gr1hu0vmULyqEasw",authDomain:"docuploaer.firebaseapp.com",projectId:"docuploaer",storageBucket:"docuploaer.firebasestorage.app",messagingSenderId:"129242766116",appId:"1:129242766116:web:c170df4aa5eb1009f2b1b1"};Object.values(d).every(e=>e&&"undefined"!==e)||console.warn("Firebase configuration is incomplete. Some features may not work properly.");try{s=0===(0,i.Dk)().length?(0,i.Wp)(d):(0,i.Dk)()[0],l=(0,n.xI)(s),r=(0,c.aU)(s),(0,o.c7)(s)}catch(e){throw console.error("Firebase initialization failed:",e),e}},6411:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(4568),l=a(3409),r=a(7620),i=a(7541),n=a(9664),c=a.n(n);function o(){let{user:e,loading:t}=(0,l.Z)(),a=(0,i.useParams)(),n=(0,i.useRouter)(),o=a.id,[d,u]=(0,r.useState)(null),[m,x]=(0,r.useState)(!0),[h,f]=(0,r.useState)(""),[g,p]=(0,r.useState)(null),b=(0,r.useRef)(!1),j=(0,r.useRef)(new Map);(0,r.useEffect)(()=>{e&&!t&&o&&v()},[e,t,o]);let v=(0,r.useCallback)(async()=>{if(!e||!o||b.current)return;let t="".concat(o,"-").concat(e.userId),a=j.current.get(t);if(a&&Date.now()-a.timestamp<3e5){u(a.file),p(a.content),x(!1);return}try{b.current=!0,x(!0),f("");let a=await fetch("/api/files?fileId=".concat(o,"&userId=").concat(e.userId)),s=await a.json();if(!s.success)throw Error(s.message||"Failed to load file");if(!s.file)throw Error("File not found");u(s.file);let l=await fetch("/api/files/content?fileId=".concat(o,"&userId=").concat(e.userId));if(l.ok){let e=await l.blob(),t=URL.createObjectURL(e);p(t)}else p(null);j.current.set(t,{file:s.file,content:g||"",timestamp:Date.now()})}catch(e){f(e.message||"Failed to load file. Please try again.")}finally{x(!1),b.current=!1}},[e,o]),y=(0,r.useCallback)(e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},[]),N=(0,r.useCallback)(e=>e.includes("pdf")?(0,s.jsx)("svg",{className:"w-12 h-12 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}):e.includes("image")?(0,s.jsx)("svg",{className:"w-12 h-12 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}):(0,s.jsx)("svg",{className:"w-12 h-12 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})}),[]),w=(0,r.useCallback)(()=>d&&g?d.mimeType.includes("image")?(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("img",{src:g,alt:d.originalName,className:"max-w-full max-h-96 object-contain rounded-lg shadow-lg"})}):"application/pdf"===d.mimeType?(0,s.jsx)("div",{className:"w-full h-96",children:(0,s.jsx)("iframe",{src:g,className:"w-full h-full border-0 rounded-lg shadow-lg",title:d.originalName})}):d.mimeType.includes("text")?(0,s.jsx)("div",{className:"bg-gray-50 p-6 rounded-lg",children:(0,s.jsx)("pre",{className:"whitespace-pre-wrap text-sm font-mono",children:g})}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:N(d.mimeType)}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"Preview not available for this file type"}),(0,s.jsx)("a",{href:g,download:d.originalName,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Download File"})]}):null,[d,g,N]);return t?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):e?m?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading document..."})]})}):h?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:h}),(0,s.jsxs)("div",{className:"space-x-4",children:[(0,s.jsx)("button",{onClick:()=>n.back(),className:"bg-gray-600 text-white px-6 py-2 rounded-md hover:bg-gray-700",children:"Go Back"}),(0,s.jsx)(c(),{href:"/files",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700",children:"My Files"})]})]})}):d?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>n.back(),className:"text-gray-500 hover:text-gray-700",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[N(d.mimeType),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:d.originalName}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[y(d.size)," â€¢ ",new Date(d.uploadedAt).toLocaleDateString()]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(c(),{href:"/files",className:"text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md text-sm font-medium",children:"My Files"}),(0,s.jsx)("a",{href:g||"#",download:d.originalName,className:"bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors",children:"Download"})]})]})})}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:w()})})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"File not found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"The requested file could not be found."}),(0,s.jsx)(c(),{href:"/files",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700",children:"Back to My Files"})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please log in to view documents"}),(0,s.jsx)("a",{href:"/login",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700",children:"Go to Login"})]})})}},7541:(e,t,a)=>{"use strict";var s=a(3041);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})}},e=>{e.O(0,[766,511,80,664,587,18,358],()=>e(e.s=4490)),_N_E=e.O()}]);