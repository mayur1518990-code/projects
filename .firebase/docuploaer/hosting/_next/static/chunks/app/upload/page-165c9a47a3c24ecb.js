(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{3959:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>o});var t=s(4568),l=s(4271),r=s(241),i=s(3409),d=s(7620);function o(){let{user:e,loading:a}=(0,i.Z)(),[s,o]=(0,d.useState)([]),[n,c]=(0,d.useState)(!1),[m,u]=(0,d.useState)(!1),[x,p]=(0,d.useState)(""),h=(0,d.useRef)(null),[g,f]=(0,d.useState)(!1);(0,d.useEffect)(()=>{let s,t=setTimeout(()=>{a&&f(!0)},3e3);return a||e||(s=setTimeout(()=>{window.location.href="/login"},1e3)),()=>{clearTimeout(t),s&&clearTimeout(s)}},[e,a]);let b=["application/pdf","image/jpeg","image/jpg","image/png","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],j=(0,d.useCallback)(e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},[]),v=(0,d.useCallback)(e=>e.includes("pdf")?(0,t.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}):e.includes("image")?(0,t.jsx)("svg",{className:"w-8 h-8 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}):(0,t.jsx)("svg",{className:"w-8 h-8 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})}),[]),y=(0,d.useCallback)(e=>{let a={pending:{color:"bg-yellow-100 text-yellow-800",text:"Pending Payment"},paid:{color:"bg-green-100 text-green-800",text:"Paid"},processing:{color:"bg-blue-100 text-blue-800",text:"Processing"},completed:{color:"bg-gray-100 text-gray-800",text:"Completed"}}[e];return(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(a.color),children:a.text})},[]),N=(0,d.useCallback)(async a=>{try{let s=new FormData;s.append("file",a),s.append("userId",(null==e?void 0:e.userId)||""),s.append("metadata",JSON.stringify({uploadedVia:"web",userAgent:navigator.userAgent}));let t=new AbortController,l=setTimeout(()=>t.abort(),3e4),r=await fetch("/api/upload",{method:"POST",body:s,signal:t.signal});if(clearTimeout(l),!r.ok)throw Error("Upload failed: ".concat(r.status," ").concat(r.statusText));let i=await r.json();if(!i.success)throw Error(i.message||"Upload failed");return localStorage.setItem("newFileUploaded",Date.now().toString()),i.file}catch(e){if("AbortError"===e.name)throw Error("Upload timeout - please try again");throw e}},[null==e?void 0:e.userId]),w=(0,d.useCallback)(async a=>{if(!e)return void p("Please log in to upload files");p(""),c(!0);try{let e=Array.from(a).map(async e=>{if(e.size>0x1400000)throw Error('File "'.concat(e.name,'" is too large. Maximum size is 20MB.'));if(!b.includes(e.type))throw Error('File "'.concat(e.name,'" is not supported. Allowed types: PDF, images, Word docs.'));let a=await N(e);return{id:a.id,name:a.originalName,size:a.size,type:a.mimeType,status:"pending",uploadDate:new Date(a.uploadedAt)}}),s=await Promise.all(e);o(e=>[...e,...s])}catch(e){p(e.message||"Upload failed. Please try again.")}finally{c(!1)}},[e]),k=(0,d.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?u(!0):"dragleave"===e.type&&u(!1)},[]),C=(0,d.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),u(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&w(e.dataTransfer.files)},[w]),D=(0,d.useCallback)(e=>{o(a=>a.map(a=>a.id===e?{...a,qrCode:"generated"}:a))},[]),P=(0,d.useMemo)(()=>s,[s]);return a&&!g?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):e?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Upload Documents"}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Upload Your Files"}),(0,t.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(m?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"),onDragEnter:k,onDragLeave:k,onDragOver:k,onDrop:C,children:[(0,t.jsx)("input",{ref:h,type:"file",className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:e=>{e.target.files&&e.target.files[0]&&w(e.target.files)}}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,t.jsx)("div",{children:n?(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),(0,t.jsx)("span",{className:"text-blue-600 font-medium text-lg",children:"Uploading files..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{var e;return null==(e=h.current)?void 0:e.click()},className:"text-blue-600 hover:text-blue-700 font-medium text-lg",disabled:n,children:"Click to upload"}),(0,t.jsx)("p",{className:"text-gray-500 mt-1",children:"or drag and drop files here"})]})}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"PDF, DOC, DOCX, JPG, PNG up to 20MB each"})]})]}),x&&(0,t.jsx)("div",{className:"mt-4 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md text-sm",children:x})]}),P.length>0&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Uploaded Files"}),(0,t.jsx)("div",{className:"space-y-4",children:P.map(e=>(0,t.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[v(e.type),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[j(e.size)," â€¢ ",e.uploadDate.toLocaleDateString()]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[y(e.status),"pending"===e.status&&(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(r.x,{amount:100,fileId:e.id,onSuccess:()=>{var a;return a=e.id,void o(e=>e.map(e=>e.id===a?{...e,status:"paid"}:e))},onError:e=>p(e)}),(0,t.jsx)(l.X,{fileId:e.id,onGenerate:()=>D(e.id)})]})]})]})},e.id))})]}),(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"How it works"}),(0,t.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-blue-800",children:[(0,t.jsx)("li",{children:"Upload your documents (PDF, images, Word docs, screenshots)"}),(0,t.jsx)("li",{children:"Complete payment to process your files"}),(0,t.jsx)("li",{children:"Generate QR codes for easy sharing and tracking"}),(0,t.jsx)("li",{children:'Track your files in the "My Files" section'})]})]})]})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please log in to upload files"}),(0,t.jsx)("a",{href:"/login",className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700",children:"Go to Login"})]})})}},4756:(e,a,s)=>{Promise.resolve().then(s.bind(s,3959))}},e=>{e.O(0,[766,511,80,799,587,18,358],()=>e(e.s=4756)),_N_E=e.O()}]);